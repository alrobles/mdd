#' Function to return mammal shapefiles from MDD
#' @importFrom utils download.file
#' @param dir A directory where to write the output
#' @return A SpatVector object with mammal shapefiles
#' @export
#' @source MDD, American Society of Mammalogists Mammal Diversity Database,
#'  \url{https://www.mammaldiversity.org/}
#'
#'
#' @examples
#' get_mdd_shp()
get_mdd_shp <- function(dir = NULL){
  url <- "https://mdd-aligned-shp-0-1-0.nyc3.cdn.digitaloceanspaces.com/mammal_shp.rds"
  
  # check if the url exists
  if (!url_exists(url)) {
    return("Can't access mammal data.")
  }
  
  
  shp <- readr::read_rds(url)
  
  if (!is.null(dir)) {
    save(shp, file = paste0(dir, "/mdd.rds"), compress = "xz")
  }
  return(terra::unwrap(shp))
}
